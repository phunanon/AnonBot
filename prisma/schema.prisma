datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id           Int       @id @default(autoincrement())
  createdAt    BigInt    @default(0)
  //Discord info
  snowflake    BigInt    @unique
  tag          String
  //Gender
  sexFlags     Int       @default(63)
  sexChanged   BigInt?
  //Reachability
  accessible   Boolean   @default(true)
  lastSeenAt   BigInt    @default(0)
  //Finding conversation
  seekingSince DateTime?
  greeting     String?
  //In conversation
  convoWith    User?     @relation("convoWith", fields: [convoWithId], references: [id])
  convoWith_   User?     @relation("convoWith")
  convoWithId  Int?      @unique
  //Stats
  numMessage   Int       @default(0)
  numConvo     Int       @default(0)
  //Blocking
  blocker      Block[]   @relation("blocker")
  blocked      Block[]   @relation("blocked")
}

model Block {
  id        Int  @id @default(autoincrement())
  blocker   User @relation("blocker", fields: [blockerId], references: [id])
  blocked   User @relation("blocked", fields: [blockedId], references: [id])
  blockerId Int
  blockedId Int
}

//sexFlags 0 0 0        0 0 0
//           MFN4MFN
// default   111 111 63
// M   F     100 010 34
// M MFN     100 111 39
// F FN      010 011 19

// Example:
// var A = 0b100010;
// var B = 0b010110;
// ((A & 7) & (B >> 3)) && !(~(A & 7) & (B >> 3)) && ((B & 7) & (A >> 3)) && !(~(B & 7) & (A >> 3))


